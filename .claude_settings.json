{
  "customInstructions": "# üéØ Princ√≠pios do Projeto Avalia 360¬∞\n\nEste projeto segue 12 princ√≠pios fundamentais de desenvolvimento que devem guiar TODAS as decis√µes de implementa√ß√£o.\n\n## üìã Prompt Mestre\n\n### 1. Arquitetura Limpa\n- **Separation of Concerns**: Cada m√≥dulo tem uma responsabilidade √∫nica e bem definida\n- **Dependency Inversion**: Depend√™ncias apontam para abstra√ß√µes, n√£o implementa√ß√µes\n- **Estrutura por Camadas**:\n  - `components/`: UI components (React)\n  - `services/`: Business logic e integra√ß√£o com APIs externas\n  - `utils/`: Fun√ß√µes puras e helpers\n  - `hooks/`: Custom React hooks\n  - `types/`: TypeScript interfaces e types\n- **Regra**: NUNCA misturar l√≥gica de neg√≥cio com componentes de UI\n- **Regra**: SEMPRE criar abstra√ß√µes para servi√ßos externos (Firebase, EmailJS)\n\n### 2. Performance Baseada na Teoria do Big O Notation\n- **NENHUM algoritmo O(N¬≤)** em c√≥digo cr√≠tico ou hot paths\n- **Preferir sempre**:\n  - O(1): Map/Set lookups\n  - O(log N): √çndices Firestore, binary search\n  - O(N): Single loop quando inevit√°vel\n- **Otimiza√ß√µes obrigat√≥rias**:\n  - React.memo para componentes que re-renderizam frequentemente\n  - useMemo para c√°lculos complexos\n  - useCallback para event handlers\n  - Virtualiza√ß√£o (react-window) para listas > 50 items\n- **M√©tricas**:\n  - Dashboard de 100 membros: < 2s\n  - Queries Firestore: < 100ms (com √≠ndices)\n  - Bundle inicial: < 60KB gzipped\n\n### 3. Mitigado Contra Principais CVEs\n- **OWASP Top 10 2021**: TODAS as vulnerabilidades devem estar mitigadas\n- **Prote√ß√µes obrigat√≥rias**:\n  - XSS: DOMPurify em TODOS os inputs de usu√°rio\n  - Injection: Valida√ß√£o e sanitiza√ß√£o de queries Firestore\n  - Path Traversal: Sanitiza√ß√£o de nomes de arquivo\n  - CSRF: Tokens √∫nicos por sess√£o\n- **CVEs espec√≠ficas documentadas** em PLANO.md com justificativa\n- **Security audit** obrigat√≥rio em CI/CD (scripts/smart-audit.cjs)\n\n### 4. Resili√™ncia dos Servi√ßos e Uso de Cache\n- **Retry logic** para opera√ß√µes cr√≠ticas:\n  - EmailJS: 3 tentativas com exponential backoff\n  - Firestore: Retry autom√°tico do SDK\n- **Cache estrat√©gico**:\n  - Queries Firestore: Cache em mem√≥ria por 5 minutos\n  - Resultados de avalia√ß√£o: Cache at√© mudan√ßa\n- **Fallbacks**:\n  - Se EmailJS falhar: Mostrar c√≥digos para copiar manualmente\n  - Se Firestore falhar: Mostrar erro amig√°vel + retry button\n- **Timeout em TODAS as opera√ß√µes ass√≠ncronas**\n\n### 5. Design Moderno Baseado No Contexto\n- **Gradientes por contexto**:\n  - Home: indigo/purple/pink\n  - Manager: blue/indigo/purple\n  - Member: emerald/teal/cyan\n- **Componentes modernos**:\n  - Rounded corners (rounded-3xl para cards)\n  - Shadows em camadas\n  - Micro-intera√ß√µes (hover scale 1.02)\n  - Anima√ß√µes sutis (fade-in, slide-up)\n- **Responsividade**: Mobile-first, breakpoints sm/md/lg/xl\n- **Acessibilidade**: WCAG AA, touch-friendly (44px+), keyboard navigation\n\n### 6. Garantia das Funcionalidades Atrav√©s da Pir√¢mide de Testes\n- **Unit Tests (Base)**: 263+ testes com Vitest\n  - Todas as fun√ß√µes puras em utils/\n  - Todos os hooks customizados\n  - Servi√ßos de criptografia e valida√ß√£o\n  - Cobertura: 80%+ (configurado em vitest.config.ts)\n- **Integration Tests (Meio)**: Testes de componentes com Testing Library\n  - Formul√°rios completos\n  - Fluxos de autentica√ß√£o\n- **E2E Tests (Topo)**: Playwright para fluxos cr√≠ticos\n  - Manager flow: Criar ‚Üí Adicionar ‚Üí Enviar\n  - Member flow: Login ‚Üí Avaliar ‚Üí Completar\n  - Full cycle: End-to-end\n- **CI/CD**: Todos os testes DEVEM passar antes de merge\n\n### 7. Seguran√ßa\n- **Criptografia**:\n  - AES-256 para dados sens√≠veis (nomes, emails, respostas)\n  - SHA-256 para hashing (emails, c√≥digos)\n  - Chaves √∫nicas por avalia√ß√£o\n- **Autentica√ß√£o**:\n  - Tokens UUID v4 para gestores\n  - C√≥digos de 6 d√≠gitos com hash para colaboradores\n  - Rate limiting: 5 tentativas em 15 minutos\n  - Expira√ß√£o: 90 dias\n- **Firestore Rules**: Deny by default, acesso baseado em tokens\n- **Headers de seguran√ßa**: CSP, HSTS, X-Frame-Options, etc.\n- **Valida√ß√µes**: TODAS as entradas validadas e sanitizadas\n\n### 8. Observabilidade\n- **Tr√™s Pilares Implementados**:\n  1. **Logging**: Logger estruturado com n√≠veis (debug/info/warn/error/critical)\n  2. **M√©tricas**: Core Web Vitals + m√©tricas de neg√≥cio\n  3. **Error Tracking**: Captura autom√°tica com stack traces\n- **Monitoramento**:\n  - Health Monitor (dev): Ctrl+Shift+H\n  - Firebase Analytics: Eventos customizados\n  - Firestore monitoring: Queries lentas alertadas\n- **M√©tricas obrigat√≥rias**:\n  - LCP < 2.5s, FID < 100ms, CLS < 0.1\n  - Taxa de conclus√£o de avalia√ß√µes\n  - Tempo de queries Firestore\n\n### 9. Princ√≠pios do Design System\n- **Tokens de design**:\n  - Cores: Sistema de gradientes por contexto\n  - Tipografia: Inter (Google Fonts), tamanhos consistentes\n  - Espa√ßamento: M√∫ltiplos de 4px\n  - Shadows: Sistema hier√°rquico (lg/xl/2xl)\n- **Componentes reutiliz√°veis**:\n  - Bot√µes com variantes (primary/secondary/outline)\n  - Cards com suporte a gradientes\n  - Inputs com √≠cones e valida√ß√£o inline\n- **Consist√™ncia**: TODOS os componentes seguem o mesmo padr√£o\n- **Documenta√ß√£o**: Storybook (futuro) para cat√°logo de componentes\n\n### 10. Constru√ß√£o Por Fases e SubFases\n- **SEMPRE seguir o plano** documentado em PLANO.md\n- **Estrutura de fases**:\n  - Fase 1: MVP (Setup + Autentica√ß√£o + CRUD b√°sico)\n  - Fase 2: Features (Excel, Dashboard, Resultados)\n  - Fase 3: Seguran√ßa (Valida√ß√µes, Sanitiza√ß√£o, Headers)\n  - Fase 4: Resili√™ncia (Retry, Cache, Error handling)\n  - Fase 5: Testes (Unit + Integration + E2E)\n  - Fase 6: Observabilidade (Logging, M√©tricas, Monitoring)\n- **Cada fase** tem subfases bem definidas\n- **NUNCA pular fases** ou implementar features fora da ordem\n- **Commits** devem referenciar a fase/subfase\n\n### 11. Altera√ß√µes Documentadas\n- **Commits sem√¢nticos obrigat√≥rios**:\n  - feat: Nova funcionalidade\n  - fix: Corre√ß√£o de bug\n  - docs: Documenta√ß√£o\n  - refactor: Refatora√ß√£o\n  - test: Testes\n  - perf: Performance\n  - security: Seguran√ßa\n- **Formato do commit**:\n  ```\n  tipo: Descri√ß√£o curta\n\n  Detalhes:\n  - Item 1\n  - Item 2\n\n  ü§ñ Generated with Claude Code\n  Co-Authored-By: Claude <noreply@anthropic.com>\n  ```\n- **README.md**: Atualizado com novas features\n- **PLANO.md**: Atualizado com decis√µes t√©cnicas\n- **Changelog**: Manter hist√≥rico de mudan√ßas\n\n### 12. Altera√ß√£o da Aplica√ß√£o com Build Funcional\n- **NUNCA commitar c√≥digo que quebra o build**\n- **Fluxo obrigat√≥rio antes de commit**:\n  1. `npm run build` ‚Üí DEVE passar sem erros\n  2. `npx tsc --noEmit` ‚Üí DEVE passar sem erros TypeScript\n  3. `npm test -- --run` ‚Üí TODOS os testes DEVEM passar\n  4. `node scripts/smart-audit.cjs` ‚Üí Security audit DEVE passar\n- **CI/CD**: Pipeline DEVE estar verde antes de merge\n- **Incremental**: Mudan√ßas pequenas e funcionais\n- **Feature flags**: Para features incompletas (evitar quebrar main)\n\n---\n\n## ü§ñ Configura√ß√µes do Agente\n\n### 1. Se Um Comando Demorar Muito Para Rodar, Cancele\n- **Timeout padr√£o**: 2 minutos para comandos bash\n- **Comandos longos**: Rodar em background com `run_in_background: true`\n- **Monitoramento**: Usar BashOutput para verificar progresso\n- **Cancelamento**: Se comando travar, matar processo e tentar alternativa\n- **Exemplos de comandos longos**:\n  - `npm test` (modo watch) ‚Üí Usar `npm test -- --run`\n  - `npm install` grande ‚Üí Mostrar progresso\n  - Build lento ‚Üí Identificar gargalos\n\n### 2. Caso Uma Solu√ß√£o N√£o Funcione, Tente Uma Nova Abordagem\n- **M√°ximo 2 tentativas** com a mesma abordagem\n- **Se falhar 2 vezes**: Mudar estrat√©gia completamente\n- **Alternativas a considerar**:\n  - Edit n√£o funciona ‚Üí Write + Read completo\n  - Query lenta ‚Üí Adicionar √≠ndice Firestore\n  - Bundle grande ‚Üí Code splitting diferente\n  - Teste falhando ‚Üí Mockar depend√™ncia\n- **Documentar**: Por que a primeira abordagem falhou\n- **Aprender**: N√£o repetir o mesmo erro\n\n### 3. Economia de Token: Foco na Implementa√ß√£o e Menos em Resumos\n- **SEM resumos longos** ap√≥s cada tarefa\n- **SEM explica√ß√µes detalhadas** do que foi feito\n- **SEM coment√°rios verbosos** no c√≥digo\n- **FOCO TOTAL** em:\n  - Escrever c√≥digo\n  - Executar comandos\n  - Corrigir erros\n  - Testar funcionamento\n- **Comunica√ß√£o m√≠nima**:\n  - \"Implementando X...\"\n  - \"Corrigindo erro Y...\"\n  - \"‚úÖ Feature Z conclu√≠da\"\n- **Usar TodoWrite** para tracking ao inv√©s de explica√ß√µes longas\n- **Resumos apenas** quando EXPLICITAMENTE solicitado pelo usu√°rio\n\n---\n\n## üéØ Prioridades em Conflito\n\nQuando houver conflito entre princ√≠pios, seguir esta ordem:\n\n1. **Seguran√ßa** (nunca comprometer)\n2. **Build funcional** (nunca quebrar)\n3. **Testes passando** (garantia de qualidade)\n4. **Performance** (experi√™ncia do usu√°rio)\n5. **Arquitetura limpa** (manutenibilidade)\n6. **Design moderno** (est√©tica)\n7. **Observabilidade** (debugging)\n8. **Documenta√ß√£o** (conhecimento)\n\n---\n\n## ‚úÖ Checklist Antes de Cada Commit\n\n- [ ] Build passa sem erros\n- [ ] TypeScript sem erros\n- [ ] Todos os testes passam\n- [ ] Security audit passa\n- [ ] C√≥digo segue arquitetura limpa\n- [ ] Performance mantida ou melhorada\n- [ ] Commit message sem√¢ntico\n- [ ] README/PLANO atualizados se necess√°rio\n\n---\n\n**Lembre-se**: Esses princ√≠pios n√£o s√£o sugest√µes, s√£o **REGRAS OBRIGAT√ìRIAS** do projeto.",
  "permissions": {
    "allow": [
      "Bash(npm create:*)",
      "Bash(npm install)",
      "Bash(npm audit:*)",
      "Bash(npm run build:*)",
      "Bash(npm test:*)",
      "Bash(git add:*)",
      "Bash(git commit -m \"$(cat <<''EOF''\\nfeat: Fase 1.1 - Setup completo do projeto\\n\\nSetup e Infraestrutura:\\n- ‚úÖ Projeto React 18 + Vite + TypeScript configurado\\n- ‚úÖ Tailwind CSS com design system completo\\n- ‚úÖ Firebase Firestore configura√ß√£o\\n- ‚úÖ Estrutura de pastas organizada\\n- ‚úÖ Vari√°veis de ambiente (.env.example)\\n- ‚úÖ Vitest + Testing Library configurados\\n- ‚úÖ ESLint configurado\\n- ‚úÖ Build otimizado (vendor splitting)\\n\\nSeguran√ßa e Criptografia:\\n- ‚úÖ Utilit√°rios de criptografia AES-256\\n- ‚úÖ Hashing SHA-256 para emails e c√≥digos\\n- ‚úÖ Gera√ß√£o de tokens UUID para gestores\\n- ‚úÖ Gera√ß√£o de c√≥digos de 6 d√≠gitos\\n- ‚úÖ 22 testes unit√°rios passando\\n\\nTipos TypeScript:\\n- ‚úÖ Interfaces completas (Evaluation, TeamMember, Response)\\n- ‚úÖ Tipos de formul√°rios e valida√ß√£o\\n- ‚úÖ Tipos de seguran√ßa e logs\\n\\nDesign:\\n- ‚úÖ Sistema de cores (primary, gray, rating)\\n- ‚úÖ Componentes CSS reutiliz√°veis\\n- ‚úÖ Anima√ß√µes e transi√ß√µes\\n- ‚úÖ Tipografia Inter do Google Fonts\\n\\nDocumenta√ß√£o:\\n- ‚úÖ PLANO.md (6.275 linhas) - Especifica√ß√£o completa\\n- ‚úÖ README.md (968 linhas) - Documenta√ß√£o do usu√°rio\\n\\nPr√≥ximos passos: Fase 1.2 - Autentica√ß√£o\\n\\nü§ñ Generated with [Claude Code](https://claude.com/claude-code)\\nCo-Authored-By: Claude <noreply@anthropic.com>\\nEOF\\n)\\\")",
      "Bash(npm install:*)",
      "Bash(git commit -m \"$(cat <<''EOF''\\nfeat: Fase 1.2 - Autentica√ß√£o e Seguran√ßa B√°sica\\n\\nValida√ß√£o e Sanitiza√ß√£o:\\n- ‚úÖ Utilit√°rios de valida√ß√£o completos (validation.ts)\\n  - Email, nome, c√≥digo de acesso, rating\\n  - Valida√ß√£o de membros de equipe (O(N))\\n  - Valida√ß√£o de formul√°rios\\n  - UUID, URL, rate limiting\\n  - 48 testes unit√°rios passando\\n\\n- ‚úÖ Utilit√°rios de sanitiza√ß√£o (sanitization.ts)\\n  - DOMPurify para preven√ß√£o de XSS\\n  - Sanitiza√ß√£o de HTML, texto, URLs\\n  - Prote√ß√£o contra NoSQL injection (Firestore)\\n  - Preven√ß√£o de path traversal\\n  - Prote√ß√£o contra prototype pollution\\n  - 70 testes unit√°rios passando\\n\\nGerenciamento de Sess√£o:\\n- ‚úÖ Sistema de sess√£o (session.ts)\\n  - Sess√µes de gestor (UUID token)\\n  - Sess√µes de colaborador (c√≥digo 6 d√≠gitos)\\n  - Expira√ß√£o autom√°tica (7 dias)\\n  - Timeout por inatividade (2 horas)\\n  - Renova√ß√£o de sess√£o\\n  - Tracking de atividade\\n  - 34 testes unit√°rios passando\\n\\nSeguran√ßa:\\n- ‚úÖ Valida√ß√£o de entrada OWASP Top 10\\n- ‚úÖ Sanitiza√ß√£o contra XSS\\n- ‚úÖ Prote√ß√£o contra injection attacks\\n- ‚úÖ Rate limiting em mem√≥ria\\n- ‚úÖ Timing-safe comparisons\\n- ‚úÖ Content Security Policy (CSP)\\n\\nTestes:\\n- ‚úÖ 174 testes unit√°rios passando\\n  - crypto: 22 testes\\n  - validation: 48 testes\\n  - sanitization: 70 testes\\n  - session: 34 testes\\n- ‚úÖ 100% de cobertura das fun√ß√µes cr√≠ticas\\n\\nPr√≥ximos passos: Fase 1.3 - Cria√ß√£o de Avalia√ß√£o (Gestor)\\n\\nü§ñ Generated with [Claude Code](https://claude.com/claude-code)\\nCo-Authored-By: Claude <noreply@anthropic.com>\\nEOF\\n)\\\")",
      "Bash(git commit:*)",
      "Bash(pkill -f \\\"npm test\\\")",
      "Bash(git push:*)",
      "Bash(cat:*)",
      "Bash(git rm:*)",
      "Bash(gh run:*)",
      "Bash(rm:*)",
      "Bash(npx tsc --noEmit)",
      "Bash(npx playwright install chromium)",
      "Bash(find:*)",
      "Bash(firebase deploy:*)",
      "Bash(npm update:*)",
      "Bash(node scripts/smart-audit.js:*)",
      "Bash(node scripts/smart-audit.cjs:*)",
      "Bash(npm view:*)",
      "Bash(git restore:*)",
      "Bash(sleep:*)",
      "Bash(wc:*)",
      "Bash(ls:*)"
    ],
    "deny": [],
    "ask": []
  }
}
